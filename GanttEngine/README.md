# ç”˜ç‰¹å›¾ç”Ÿæˆå™¨ (GanttEngine)

## ğŸ“‹ æ¦‚è¿°

GanttEngine æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç”˜ç‰¹å›¾ç”Ÿæˆå·¥å…·ï¼Œå¯ä»¥ä» Excel æ–‡ä»¶è¯»å–é¡¹ç›®ä»»åŠ¡æ•°æ®ï¼Œè‡ªåŠ¨ç”Ÿæˆç¾è§‚çš„äº¤äº’å¼ç”˜ç‰¹å›¾ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ“¤ **Excel æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒ .xlsx å’Œ .xls æ ¼å¼
- ğŸ¨ **äº¤äº’å¼ç”˜ç‰¹å›¾**: ä½¿ç”¨ Plotly åˆ›å»ºå¯äº¤äº’ã€å¯ç¼©æ”¾çš„ç”˜ç‰¹å›¾
- ğŸ“Š **è¿›åº¦æ˜¾ç¤º**: å¯è§†åŒ–å±•ç¤ºä»»åŠ¡å®Œæˆè¿›åº¦
- ğŸ·ï¸ **çµæ´»åˆ†ç»„**: æ”¯æŒæŒ‰åˆ†ç±»ã€è´Ÿè´£äººåˆ†ç»„æˆ–ä¸åˆ†ç»„
- ğŸ¨ **å¤šç§é…è‰²**: æä¾›å¤šç§é¢œè‰²æ–¹æ¡ˆé€‰æ‹©
- ğŸ’¾ **å¯¼å‡ºåŠŸèƒ½**: æ”¯æŒä¸‹è½½ HTML æ ¼å¼çš„ç”˜ç‰¹å›¾
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§å±å¹•å°ºå¯¸

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

ä¸»è¦ä¾èµ–ï¼š
- `pandas >= 2.0.0` - æ•°æ®å¤„ç†
- `openpyxl >= 3.1.0` - Excel æ–‡ä»¶è¯»å†™
- `plotly >= 5.17.0` - å›¾è¡¨ç”Ÿæˆ
- `flask >= 2.3.3` - Web æ¡†æ¶

### 2. å¯åŠ¨åº”ç”¨

```bash
python app.py
```

### 3. è®¿é—®ç”˜ç‰¹å›¾é¡µé¢

åœ¨æµè§ˆå™¨ä¸­è®¿é—®: `http://localhost:5000/gantt`

## ğŸ“ Excel æ–‡ä»¶æ ¼å¼

### å¿…éœ€åˆ—

| åˆ—å | è¯´æ˜ | æ ¼å¼ | ç¤ºä¾‹ |
|------|------|------|------|
| ä»»åŠ¡åç§° | ä»»åŠ¡çš„åç§° | æ–‡æœ¬ | é¡¹ç›®å¯åŠ¨ |
| å¼€å§‹æ—¥æœŸ | ä»»åŠ¡å¼€å§‹æ—¥æœŸ | YYYY-MM-DD | 2024-01-01 |
| ç»“æŸæ—¥æœŸ | ä»»åŠ¡ç»“æŸæ—¥æœŸ | YYYY-MM-DD | 2024-01-15 |

### å¯é€‰åˆ—

| åˆ—å | è¯´æ˜ | æ ¼å¼ | ç¤ºä¾‹ |
|------|------|------|------|
| è´Ÿè´£äºº | ä»»åŠ¡è´Ÿè´£äºº | æ–‡æœ¬ | å¼ ä¸‰ |
| è¿›åº¦ | å®Œæˆç™¾åˆ†æ¯” | 0-100 | 50 |
| åˆ†ç±» | ä»»åŠ¡åˆ†ç±»/ç±»å‹ | æ–‡æœ¬ | å¼€å‘ |

### æ”¯æŒçš„åˆ—åï¼ˆä¸­è‹±æ–‡ï¼‰

ç³»ç»Ÿæ”¯æŒå¤šç§åˆ—åæ ¼å¼ï¼ŒåŒ…æ‹¬ï¼š

**ä»»åŠ¡åç§°**: ä»»åŠ¡åç§°ã€ä»»åŠ¡ã€Task Nameã€Taskã€é¡¹ç›®åç§°ã€é¡¹ç›®
**å¼€å§‹æ—¥æœŸ**: å¼€å§‹æ—¥æœŸã€å¼€å§‹æ—¶é—´ã€Start Dateã€Startã€å¼€å§‹
**ç»“æŸæ—¥æœŸ**: ç»“æŸæ—¥æœŸã€ç»“æŸæ—¶é—´ã€End Dateã€Endã€ç»“æŸã€å®Œæˆæ—¥æœŸ
**è´Ÿè´£äºº**: è´Ÿè´£äººã€è´£ä»»äººã€Ownerã€Assigneeã€æˆå‘˜
**è¿›åº¦**: è¿›åº¦ã€å®Œæˆåº¦ã€Progressã€Completeã€ç™¾åˆ†æ¯”
**åˆ†ç±»**: åˆ†ç±»ã€ç±»å‹ã€Categoryã€Typeã€æ ‡ç­¾

### ç¤ºä¾‹æ•°æ®

```excel
ä»»åŠ¡åç§°      | å¼€å§‹æ—¥æœŸ    | ç»“æŸæ—¥æœŸ    | è´Ÿè´£äºº | è¿›åº¦ | åˆ†ç±»
------------ | ---------- | ---------- | ----- | ---- | ----
é¡¹ç›®å¯åŠ¨      | 2024-01-01 | 2024-01-02 | å¼ ä¸‰   | 100  | ç®¡ç†
éœ€æ±‚åˆ†æ      | 2024-01-03 | 2024-01-10 | æå››   | 80   | è§„åˆ’
ç³»ç»Ÿè®¾è®¡      | 2024-01-11 | 2024-01-20 | ç‹äº”   | 60   | è§„åˆ’
å‰ç«¯å¼€å‘      | 2024-01-15 | 2024-02-15 | èµµå…­   | 40   | å¼€å‘
åç«¯å¼€å‘      | 2024-01-15 | 2024-02-15 | é’±ä¸ƒ   | 30   | å¼€å‘
```

## ğŸ¨ ä½¿ç”¨æ–¹æ³•

### Web ç•Œé¢ä½¿ç”¨

1. **ä¸‹è½½æ¨¡æ¿**
   - ç‚¹å‡»"ä¸‹è½½ Excel æ¨¡æ¿"æŒ‰é’®è·å–ç¤ºä¾‹æ–‡ä»¶
   - æˆ–è®¿é—®: `http://localhost:5000/api/gantt/template`

2. **å¡«å†™ Excel æ–‡ä»¶**
   - ä½¿ç”¨æ¨¡æ¿æˆ–æŒ‰ç…§æ ¼å¼è¦æ±‚åˆ›å»ºè‡ªå·±çš„ Excel æ–‡ä»¶
   - å¡«å†™ä»»åŠ¡ä¿¡æ¯ï¼ˆä»»åŠ¡åç§°ã€å¼€å§‹æ—¥æœŸã€ç»“æŸæ—¥æœŸæ˜¯å¿…éœ€çš„ï¼‰

3. **ä¸Šä¼ æ–‡ä»¶**
   - ç‚¹å‡»ä¸Šä¼ åŒºåŸŸæˆ–æ‹–æ‹½æ–‡ä»¶åˆ°ä¸Šä¼ åŒºåŸŸ
   - ç³»ç»Ÿæ”¯æŒ .xlsx å’Œ .xls æ ¼å¼ï¼Œæœ€å¤§ 10MB

4. **é…ç½®é€‰é¡¹**
   - **å›¾è¡¨æ ‡é¢˜**: è‡ªå®šä¹‰ç”˜ç‰¹å›¾æ ‡é¢˜
   - **åˆ†ç»„æ–¹å¼**: é€‰æ‹©æŒ‰åˆ†ç±»ã€è´Ÿè´£äººåˆ†ç»„æˆ–ä¸åˆ†ç»„
   - **é¢œè‰²æ–¹æ¡ˆ**: é€‰æ‹©å–œæ¬¢çš„é…è‰²æ–¹æ¡ˆ
   - **æ˜¾ç¤ºè¿›åº¦**: æ˜¯å¦åœ¨å›¾è¡¨ä¸­æ˜¾ç¤ºä»»åŠ¡å®Œæˆè¿›åº¦

5. **ç”Ÿæˆç”˜ç‰¹å›¾**
   - ç‚¹å‡»"ç”Ÿæˆç”˜ç‰¹å›¾"æŒ‰é’®
   - ç³»ç»Ÿä¼šè‡ªåŠ¨è§£ææ–‡ä»¶å¹¶ç”Ÿæˆäº¤äº’å¼ç”˜ç‰¹å›¾

6. **æŸ¥çœ‹å’Œå¯¼å‡º**
   - åœ¨é¡µé¢ä¸­é¢„è§ˆç”Ÿæˆçš„ç”˜ç‰¹å›¾
   - å¯ä»¥ç¼©æ”¾ã€æ‹–æ‹½ã€æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
   - ç‚¹å‡»"ä¸‹è½½ç”˜ç‰¹å›¾"ä¿å­˜ HTML æ–‡ä»¶

### API ä½¿ç”¨

#### 1. ä¸Šä¼ å¹¶ç”Ÿæˆç”˜ç‰¹å›¾

**è¯·æ±‚**:
```bash
POST /api/gantt/upload
Content-Type: multipart/form-data

file: [Excelæ–‡ä»¶]
title: é¡¹ç›®æ—¶é—´è½´ç”˜ç‰¹å›¾ (å¯é€‰)
group_by: category (å¯é€‰: category/owner/none)
show_progress: true (å¯é€‰: true/false)
color_scheme: default (å¯é€‰: default/pastel/bold/vivid/safe)
```

**å“åº”**:
```json
{
  "success": true,
  "message": "ç”˜ç‰¹å›¾ç”ŸæˆæˆåŠŸ",
  "summary": {
    "total_tasks": 10,
    "start_date": "2024-01-01",
    "end_date": "2024-03-01",
    "total_days": 60,
    "categories": ["ç®¡ç†", "è§„åˆ’", "å¼€å‘", "æµ‹è¯•"],
    "owners": ["å¼ ä¸‰", "æå››", "ç‹äº”"],
    "avg_progress": 45.5
  },
  "file_id": "20240101_123456_abc123",
  "chart_url": "/api/gantt/view/20240101_123456_abc123",
  "download_url": "/api/gantt/download/20240101_123456_abc123"
}
```

#### 2. æŸ¥çœ‹ç”˜ç‰¹å›¾

```bash
GET /api/gantt/view/{file_id}
```

è¿”å›: HTML é¡µé¢

#### 3. ä¸‹è½½ç”˜ç‰¹å›¾

```bash
GET /api/gantt/download/{file_id}
```

è¿”å›: HTML æ–‡ä»¶ä¸‹è½½

#### 4. åˆ—å‡ºæ‰€æœ‰å›¾è¡¨

```bash
GET /api/gantt/list
```

**å“åº”**:
```json
{
  "success": true,
  "charts": [
    {
      "file_id": "20240101_123456_abc123",
      "filename": "gantt_20240101_123456_abc123.html",
      "created_at": "2024-01-01 12:34:56",
      "size": 524288,
      "view_url": "/api/gantt/view/20240101_123456_abc123",
      "download_url": "/api/gantt/download/20240101_123456_abc123"
    }
  ],
  "total": 1
}
```

#### 5. åˆ é™¤å›¾è¡¨

```bash
DELETE /api/gantt/delete/{file_id}
```

#### 6. ä¸‹è½½æ¨¡æ¿

```bash
GET /api/gantt/template
```

è¿”å›: Excel æ¨¡æ¿æ–‡ä»¶

#### 7. å¥åº·æ£€æŸ¥

```bash
GET /api/gantt/health
```

**å“åº”**:
```json
{
  "status": "healthy",
  "service": "GanttEngine",
  "version": "1.0.0"
}
```

## ğŸ Python API ä½¿ç”¨

### åŸºæœ¬ä½¿ç”¨

```python
from GanttEngine import ExcelParser, GanttGenerator

# è§£æ Excel æ–‡ä»¶
parser = ExcelParser('project_plan.xlsx')
tasks = parser.parse()

# ç”Ÿæˆç”˜ç‰¹å›¾
generator = GanttGenerator(tasks, color_scheme='default')
fig = generator.generate(
    title='æˆ‘çš„é¡¹ç›®è®¡åˆ’',
    group_by='category',
    show_progress=True
)

# ä¿å­˜ä¸º HTML
generator.save_html('gantt_chart.html')

# æˆ–è·å– HTML å­—ç¬¦ä¸²
html_string = generator.get_html_string()
```

### é«˜çº§ä½¿ç”¨

```python
from GanttEngine import ExcelParser, GanttGenerator

# è§£ææ–‡ä»¶
parser = ExcelParser('project_plan.xlsx')
tasks = parser.parse()

# è·å–æ‘˜è¦ä¿¡æ¯
summary = parser.get_summary()
print(f"å…±æœ‰ {summary['total_tasks']} ä¸ªä»»åŠ¡")
print(f"é¡¹ç›®å‘¨æœŸ: {summary['start_date']} åˆ° {summary['end_date']}")

# ç”Ÿæˆå¤šç§æ ·å¼çš„ç”˜ç‰¹å›¾
color_schemes = ['default', 'pastel', 'bold', 'vivid', 'safe']

for scheme in color_schemes:
    generator = GanttGenerator(tasks, color_scheme=scheme)
    fig = generator.generate(
        title=f'é¡¹ç›®è®¡åˆ’ - {scheme} é…è‰²',
        group_by='owner',
        show_progress=True,
        height=800
    )
    generator.save_html(f'gantt_{scheme}.html')
```

## ğŸ“‚ ç›®å½•ç»“æ„

```
GanttEngine/
â”œâ”€â”€ __init__.py              # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ excel_parser.py          # Excel æ–‡ä»¶è§£æå™¨
â”œâ”€â”€ gantt_generator.py       # ç”˜ç‰¹å›¾ç”Ÿæˆå™¨
â”œâ”€â”€ flask_interface.py       # Flask API æ¥å£
â”œâ”€â”€ create_template.py       # æ¨¡æ¿ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ README.md               # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ templates/              # æ¨¡æ¿ç›®å½•
â”‚   â””â”€â”€ gantt_template.xlsx # Excel æ¨¡æ¿
â”œâ”€â”€ uploads/                # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â””â”€â”€ outputs/                # ç”Ÿæˆçš„å›¾è¡¨ç›®å½•
```

## ğŸ¨ é…è‰²æ–¹æ¡ˆ

- **default**: é»˜è®¤é…è‰²ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯
- **pastel**: æŸ”å’Œé…è‰²ï¼Œé€‚åˆæ‰“å°
- **bold**: é²œè‰³é…è‰²ï¼Œé€‚åˆæ¼”ç¤º
- **vivid**: æ´»åŠ›é…è‰²ï¼Œè‰²å½©å¯¹æ¯”å¼ºçƒˆ
- **safe**: å®‰å…¨é…è‰²ï¼Œè‰²ç›²å‹å¥½

## âš™ï¸ é…ç½®é€‰é¡¹

### åˆ†ç»„æ–¹å¼

- **category**: æŒ‰ä»»åŠ¡åˆ†ç±»åˆ†ç»„ï¼ˆé»˜è®¤ï¼‰
- **owner**: æŒ‰è´Ÿè´£äººåˆ†ç»„
- **none**: ä¸åˆ†ç»„ï¼ŒæŒ‰å¼€å§‹æ—¥æœŸæ’åº

### å›¾è¡¨é«˜åº¦

é»˜è®¤é«˜åº¦æ ¹æ®ä»»åŠ¡æ•°é‡è‡ªåŠ¨è®¡ç®—: `max(600, ä»»åŠ¡æ•°é‡ Ã— 40 + 200)` åƒç´ 

## ğŸ”§ æ•…éšœæ’é™¤

### Excel è§£æé”™è¯¯

**é—®é¢˜**: "ç¼ºå°‘å¿…éœ€çš„åˆ—"é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿ Excel æ–‡ä»¶åŒ…å«"ä»»åŠ¡åç§°"ã€"å¼€å§‹æ—¥æœŸ"ã€"ç»“æŸæ—¥æœŸ"åˆ—
- æ£€æŸ¥åˆ—åæ˜¯å¦æ­£ç¡®ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼Œè§"æ”¯æŒçš„åˆ—å"éƒ¨åˆ†ï¼‰
- ç¡®ä¿æ²¡æœ‰åˆå¹¶å•å…ƒæ ¼

### æ—¥æœŸæ ¼å¼é”™è¯¯

**é—®é¢˜**: "æ— æ³•è§£ææ—¥æœŸ"é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨æ ‡å‡†æ—¥æœŸæ ¼å¼: YYYY-MM-DD (å¦‚ 2024-01-01)
- ä¹Ÿæ”¯æŒ: YYYY/MM/DD, YYYY.MM.DD
- ç¡®ä¿æ—¥æœŸå•å…ƒæ ¼æ ¼å¼ä¸º"æ—¥æœŸ"ç±»å‹

### æ–‡ä»¶ä¸Šä¼ å¤±è´¥

**é—®é¢˜**: æ–‡ä»¶ä¸Šä¼ åæ²¡æœ‰ååº”

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡ 10MB
- ç¡®ä¿æ–‡ä»¶æ ¼å¼ä¸º .xlsx æˆ– .xls
- æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸåï¼ˆå°è¯•åœ¨ Excel ä¸­æ‰“å¼€ï¼‰

### å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸

**é—®é¢˜**: ç”˜ç‰¹å›¾æ˜¾ç¤ºä¸æ­£å¸¸

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- å°è¯•ä¸åŒçš„æµè§ˆå™¨ï¼ˆæ¨è Chrome, Firefoxï¼‰
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•

## ğŸ“Š æœ€ä½³å®è·µ

1. **ä»»åŠ¡æ•°é‡**: å»ºè®®å•ä¸ªç”˜ç‰¹å›¾ä¸è¶…è¿‡ 100 ä¸ªä»»åŠ¡ï¼Œä»¥ä¿æŒè‰¯å¥½çš„å¯è¯»æ€§
2. **æ—¶é—´è·¨åº¦**: é€‚åˆå±•ç¤º 1-12 ä¸ªæœˆçš„é¡¹ç›®è®¡åˆ’
3. **ä»»åŠ¡å‘½å**: ä½¿ç”¨ç®€çŸ­æ˜ç¡®çš„ä»»åŠ¡åç§°ï¼ˆå»ºè®®ä¸è¶…è¿‡ 30 ä¸ªå­—ç¬¦ï¼‰
4. **è¿›åº¦æ›´æ–°**: å®šæœŸæ›´æ–°ä»»åŠ¡è¿›åº¦ï¼Œä¿æŒç”˜ç‰¹å›¾çš„æ—¶æ•ˆæ€§
5. **åˆ†ç±»ç®¡ç†**: åˆç†è®¾ç½®ä»»åŠ¡åˆ†ç±»ï¼Œä¾¿äºåˆ†ç»„å±•ç¤º

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ“® è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

**BettaFish èˆ†æƒ…åˆ†æç³»ç»Ÿ** - è‡´åŠ›äºæ‰“é€ ç®€æ´å®ç”¨çš„å…¬å…±èˆ†è®ºåˆ†æå¹³å°
